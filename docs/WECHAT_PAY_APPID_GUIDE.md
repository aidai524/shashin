# 微信支付 AppID 申请指南

## 为什么需要 AppID？

微信支付的 Native 支付（扫码支付）**必须提供 AppID**，即使是扫码支付也需要关联一个微信应用身份。

## 获取 AppID 的三种方式

### 方式 1：微信小程序（推荐，最快）

**优点：**
- 审核快速（1-2 个工作日）
- 个人/企业都可以注册
- 适合后续开发小程序

**步骤：**

1. **注册小程序**
   - 访问：https://mp.weixin.qq.com/
   - 点击"立即注册"
   - 选择"小程序"账号类型
   - 填写基本信息（邮箱、密码等）

2. **完善小程序信息**
   - 登录小程序后台
   - 设置小程序名称、头像、介绍
   - 选择类目（如"工具"、"IT 科技"）

3. **获取 AppID**
   - 进入"开发" → "开发管理" → "开发设置"
   - 复制"AppID(小程序ID)"
   - 格式如：`wx1234567890abcdef`

4. **配置支付功能**
   - 进入"功能" → "微信支付"
   - 点击"开通"
   - 关联您的商户号（1105396457）

**时间：** 1-2 个工作日（个人）或 当天（企业认证）

---

### 方式 2：微信公众号（服务号）

**优点：**
- 适合企业用户
- 可以同时做公众号运营

**缺点：**
- 需要企业认证（300 元/年）
- 审核时间较长（3-5 个工作日）

**步骤：**

1. **注册服务号**
   - 访问：https://mp.weixin.qq.com/
   - 选择"公众号" → "服务号"
   - 完成企业认证

2. **获取 AppID**
   - 登录公众号后台
   - 进入"开发" → "基本配置"
   - 复制"开发者ID(AppID)"

3. **开通微信支付**
   - 进入"微信支付" → "商户号管理"
   - 关联您的商户号（1105396457）

**时间：** 3-5 个工作日

---

### 方式 3：微信开放平台（移动应用）

**优点：**
- 适合有 App 的场景
- 可以同时开发 iOS/Android 应用

**步骤：**

1. **注册开放平台账号**
   - 访问：https://open.weixin.qq.com/
   - 完成开发者资质认证（企业）

2. **创建应用**
   - 进入"管理中心"
   - 点击"创建应用"
   - 填写应用信息

3. **获取 AppID**
   - 应用审核通过后
   - 在应用详情页查看 AppID

4. **关联商户号**
   - 在应用中开通微信支付
   - 关联您的商户号（1105396457）

**时间：** 7 个工作日

---

## 推荐方案对比

| 方式 | 适用场景 | 费用 | 审核时间 | 推荐度 |
|------|---------|------|---------|--------|
| **小程序** | 个人/企业 | 免费 | 1-2 天 | ⭐⭐⭐⭐⭐ |
| **服务号** | 企业运营 | 300元/年 | 3-5 天 | ⭐⭐⭐ |
| **开放平台** | 有 App | 300元/年 | 7 天 | ⭐⭐ |

---

## 获取 AppID 后的配置步骤

一旦您获得了 AppID，只需要两步配置：

### 1. 更新 Cloudflare Workers Secret

```bash
echo "您的AppID" | wrangler secret put WECHAT_PAY_APPID
```

或者在 Cloudflare Dashboard 中更新 `WECHAT_PAY_APPID` 的值。

### 2. 验证配置

无需重新部署代码，Secret 更新后立即生效。

您可以：
1. 访问 `/pricing.html` 选择套餐
2. 点击"立即订阅"
3. 生成支付二维码
4. 使用微信扫码完成测试支付

---

## 临时测试方案（仅供开发测试）

如果您只是想测试接口流程，可以暂时使用测试 AppID：

```bash
echo "wx1234567890abcdef" | wrangler secret put WECHAT_PAY_APPID
```

**⚠️ 警告：**
- 此 AppID 不是真实的，**无法完成真实支付**
- 仅用于测试接口调用是否正常
- 真实上线必须使用正式 AppID

---

## 常见问题

### Q: 我已经有了微信商户号，为什么还需要 AppID？

A: 微信支付采用"商户号 + AppID"的双重身份验证：
- 商户号：用于资金结算
- AppID：标识是哪个应用发起的支付请求

### Q: 个人可以注册哪种？

A: 个人只能注册**微信小程序**，服务号和开放平台需要企业资质。

### Q: 我有多个应用，可以用同一个 AppID 吗？

A: 可以，但建议：
- 测试环境：使用同一个 AppID
- 生产环境：每个应用使用独立的 AppID，便于管理和统计

### Q: AppID 和商户号如何关联？

A: 在微信支付商户平台（https://pay.weixin.qq.com/）中：
1. 登录商户平台
2. 进入"产品中心" → "AppID 授权管理"
3. 添加您的 AppID
4. 确认关联

---

## 下一步

✅ **选择方式并注册** → ⏳ **等待审核** → 🔑 **获取 AppID** → ⚙️ **配置 Secret** → 💰 **开始测试支付**

有任何问题随时联系我！
